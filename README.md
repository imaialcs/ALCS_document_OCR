# ALCS文書OCR

## 概要

「ALCS文書OCR」は、会計事務所やバックオフィス業務の効率化を目的としたデスクトップアプリケーションです。
画像やPDF形式の書類をGoogle Gemini APIを利用して高精度にOCR処理し、編集可能なデータに変換します。

## 主な機能

- **多様なファイル形式に対応:** PNG, JPG, PDF形式のファイルを複数同時にアップロードできます。
- **高精度OCR:** Google Gemini APIを利用し、勤怠管理表や請求書などの複雑なフォーマットから情報を抽出します。
- **ローカル画像前処理:** APIに画像を送信する前に、ローカルで画像の最適化（リサイズ、トリミング、コントラスト調整）を行い、認識精度と処理速度を向上させます。
- **3つの認識モード:**
    - **タイムカード形式:** 日付、時間、氏名などを自動で認識します。
    - **テーブル形式:** 請求書や明細書などの表データをヘッダーと行データに分けて認識します。
    - **文字起こし形式:** 上記以外の文書を単純にテキスト化します。
- **高機能なデータ編集:**
    - 認識結果の表は、スプレッドシートのように直感的に操作できます。
    - 右クリックメニューから、行や列の挿入・削除、コピー、カット＆ペーストが可能です。
    - ドラッグ＆ドロップによる行・列の移動にも対応しています。
- **柔軟な表操作:**
    - 「上の表と結合」ボタンで、複数の表を一つにまとめることができます。
    - 右クリックメニューの「この行で表を分割」機能で、一つの表を二つに分けることができます。
- **Excelエクスポート:**
    - 認識結果を新しいExcelファイル(.xlsx)としてダウンロード。
    - 既存のExcelテンプレートにデータを転記。
- **氏名自動補正:** 社員名簿などを利用して、OCRが読み取った氏名を自動で補正し、精度を向上させます。
- **自動アップデート:** アプリケーションは起動時に新しいバージョンを自動で確認し、更新します。

## 動作環境

- Windows

## インストールと使い方

1.  [GitHubリリースページ](https://github.com/imaialcs/ALCS_document_OCR/releases)から最新版のインストーラー (`ALCS文書OCR-Setup-X.X.X.exe`) をダウンロードします。
2.  ダウンロードしたインストーラーを実行し、画面の指示に従ってインストールします。
3.  アプリケーションを起動し、ファイルをドラッグ＆ドロップしてOCR処理を開始します。

## 変更履歴

### v1.1.2 (2025-09-25)

- **機能追加:** 画像の前処理機能をローカルで実行するハイブリッド構成を実装しました。
    - API送信前に、画像の最適化（リサイズ）、余白の自動トリミング、コントラストの自動調整を行います。
    - これにより、OCR精度と処理速度の向上が期待できます。
    - 各前処理はオプション画面でON/OFFの切り替えが可能です。
- **アーキテクチャ変更:** Node.js固有の画像処理ライブラリ(`jimp`)を、Electronのメインプロセスで実行し、IPC通信でレンダラープロセスと連携するよう修正しました。これにより、アプリケーションの安定性が向上しました。
- **UI修正:** オプション設定のUIレイアウトを改善し、アイコン表示を修正しました。

### v1.1.1 (2025-09-22)

- **機能改善:** スプレッドシートでの行の挿入・削除機能が正しく動作するようになりました。
- **バグ修正:** ダウンロードされるExcelファイルに常に.xlsx拡張子が付与されるよう修正しました。
- **UI修正:** 「すべての表をダウンロード」ボタンの表示を修正しました。

### v1.1.0 (2025-09-22)

- **バグ修正:** OCR処理の実行後、特定の条件下で画面が真っ白になりクラッシュする重大な不具合を修正しました。
- **機能改善:** スプレッドシートの右クリックメニューが、Handsontableの公式日本語言語パックを使用するように変更され、安定性が向上しました。

## 開発者向け情報

### 主要な技術スタック

- [Electron](https://www.electronjs.org/)
- [React](https://reactjs.org/)
- [TypeScript](https://www.typescriptlang.org/)
- [Vite](https://vitejs.dev/)
- [Tailwind CSS](https://tailwindcss.com/)
- [Google Gemini API](https://ai.google.dev/)
- [Python](https://www.python.org/) (Excelテンプレートへの転記処理)

### ビルド方法

```bash
# 依存関係をインストール
npm install

# 開発環境の起動 (単一のターミナルで実行)
npm run dev

# アプリケーションをビルド（Windows向け）
npm run dist
```
ビルドされたファイルは`build_output`ディレクトリに出力されます。

## ライセンス

このプロジェクトはMITライセンスの下で公開されています。

## 作者

- alcs
